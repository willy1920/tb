<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Rapot Tunas Bangsa Kubu Raya</title>
	<link rel="stylesheet" href="style/general.css">
	<link rel="stylesheet" href="style/login.css">
	<script src="js/ajax.js"></script>
	
</head>

<body class="login">
	<header class="loginHeader">
		<h1>Tunas Bangsa Kubu Raya</h1>
	</header>
	<section id="internal" class="loginForm">
		<main>
			<h1>Admin Login</h1>
			<input type="text"id="user" placeholder="username" autofocus>
			<br>
			<input type="password"id="internalPass" placeholder="password">
			<br>
			<button class="loginSubmit" onclick="loginInternal()">Submit</button>
			<button class="loginSide" onclick="changeToExternal()">Parent Form</button>
		</main>
	</section>
	<section id="external" class="loginForm">
		<main>
			<h1>Parent Login</h1>
			<input type="email" id="email" placeholder="email">
			<br>
			<input type="password" id="externalPass" placeholder="password">
			<br>
			<button class="loginSubmit" onclick="loginExternal()">Submit</button>
			<button class="loginSide" onclick="changeToInternal()">Admin Form</button>
		</main>
	</section>
	<script type='text/javascript'>
		function loginInternal() {
			var user = document.getElementById('user').value;
			var pass = document.getElementById('internalPass').value;
			var input = "user=" + user + "&pass=" + pass;

			var ajaxRequest = ajax(ajaxRequest);
			ajaxRequest.onreadystatechange = function () {
				if (ajaxRequest.readyState == 4 && ajaxRequest.status == 200) {
					var respon = ajaxRequest.responseText;
					if (respon == 0) {
						window.location = "admin.php";
					}
					else if (respon == 1) {
						window.location = "guru.php";
					}
					else {
						alert(respon);
					}
				}
			}

			ajaxRequest.open("POST", "control/login.php", true);
			ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			ajaxRequest.send(input);
		}
		function loginExternal() {
			var email = document.getElementById('email').value;
			var pass = document.getElementById('externalPass').value;
			var input = "email=" + email + "&pass=" + pass;

			var ajaxRequest = ajax(ajaxRequest);
			ajaxRequest.onreadystatechange = function () {
				if (ajaxRequest.readyState == 4 && ajaxRequest.status == 200) {
					var respon = ajaxRequest.responseText;
					if (respon == 1) {
						window.location = "parent.php";
					}
					else {
						alert(respon);
					}
				}
			}

			ajaxRequest.open("POST", "control/loginExternal.php", true);
			ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			ajaxRequest.send(input);
		}
		function changeToInternal() {
			document.getElementById('internal').style.display = 'flex';
			document.getElementById('external').style.display = 'none';
		}
		function changeToExternal() {
			document.getElementById('internal').style.display = 'none';
			document.getElementById('external').style.display = 'flex';
		}
		
		document.getElementById('internalPass').addEventListener('keydown', internalCheckEnter, false);
		document.getElementById('externalPass').addEventListener('keydown', externalCehckEnter, false);
		function internalCheckEnter(event) {
			if (event.keyCode == 13) {
				loginInternal();
			}
		}

		function externalCehckEnter(event) {
			if (event.keyCode == 13) {
				loginExternal();
			}
		}
	</script>
</body>

</html>